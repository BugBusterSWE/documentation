language:
        - ruby

sudo : required

branches:
    only:
        - master

install:
    - sudo add-apt-repository ppa:texlive-backports/ppa -y -qq
    - sudo apt-get update -y -qq
    - sudo apt-get install texlive-latex-extra -y -qq
    - sudo apt-get install texlive-luatex -y -qq
    - sudo apt-get install texlive-fonts-extra -y -qq
    - sudo apt-get install cm-super -y -qq
    - sudo apt-get install texlive-bibtex-extra -y -qq
    - sudo apt-get install latexmk -y -qq
    - sudo apt-get install tex4ht -y -qq
    - sudo apt-get install texlive-fonts-recommended  -y -qq
    - wget http://tug.org/fonts/getnonfreefonts/install-getnonfreefonts
    - sudo texlua install-getnonfreefonts
    - sudo getnonfreefonts-sys garamond

script:
    - cd RR/NormeDiProgetto/ && latexmk -pdflatex='pdflatex -interaction=nonstopmode' -pdf && cd -
    - cd RR/StudioDiFattibilita/ && latexmk -pdflatex='pdflatex -interaction=nonstopmode' -pdf && cd -
    - cd RR/PianoDiQualifica/ && latexmk -pdflatex='pdflatex -interaction=nonstopmode' -pdf && cd -
    - cd RR/LetteraDiPresentazione/ && latexmk -pdflatex='pdflatex -interaction=nonstopmode' -pdf && cd -
    - cd RR/PianoDiProgetto/ && latexmk -pdflatex='pdflatex -interaction=nonstopmode' -pdf && cd -
    - cd RR/AnalisiDeiRequisiti/ && latexmk -pdflatex='pdflatex -interaction=nonstopmode' -pdf && cd -
    - cd RR/Glossario/ && ./build.sh; cd -

after_success:
    - git config --global user.email ${GIT_EMAIL}
    - git config --global user.name ${GIT_NAME}
    - git clone --branch=gh-pages https://${GH_TOKEN}@github.com/bugbusterswe/documentation travis-build
    - cd travis-build/
    - mkdir -p build/
    - cd build/
    - cp -f $HOME/build/BugBusterSWE/documentation/RR/NormeDiProgetto/main.pdf .
    - cp -f $HOME/build/BugBusterSWE/documentation/RR/AnalisiDeiRequisiti/main.pdf .
    - mv main.pdf NormeDiProgetto_lastest.pdf
    - cp -f $HOME/build/BugBusterSWE/documentation/RR/StudioDiFattibilita/main.pdf .
    - mv main.pdf StudioDiFattibilita_lastest.pdf
    - cp -f $HOME/build/BugBusterSWE/documentation/RR/PianoDiQualifica/main.pdf .
    - mv main.pdf PianoDiQualifica_lastest.pdf
    - cp -f $HOME/build/BugBusterSWE/documentation/RR/LetteraDiPresentazione/main.pdf .
    - mv main.pdf LetteraDiPresentazione_lastest.pdf
    - cp -f $HOME/build/BugBusterSWE/documentation/RR/PianoDiProgetto/main.pdf .
    - mv main.pdf PianoDiProgetto_lastest.pdf
    - cp -f $HOME/build/BugBusterSWE/documentation/RR/Glossario/main.pdf .
    - mv main.pdf Glossario_lastest.pdf
    - cp -f $HOME/build/BugBusterSWE/documentation/RR/AnalisiDeiRequisiti/main.pdf .
    - mv main.pdf AnalisiDeiRequisiti_lastest.pdf
    - git add NormeDiProgetto_lastest.pdf StudioDiFattibilita_lastest.pdf PianoDiQualifica_lastest.pdf LetteraDiPresentazione_lastest.pdf PianoDiProgetto_lastest.pdf Glossario_lastest.pdf AnalisiDeiRequisiti_lastest.pdf
    - git commit -m "Travis CI autocommit from travis build ${TRAVIS_BUILD_NUMBER}"
    - git push -f origin gh-pages
